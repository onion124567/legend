{"version":3,"sources":["assets/scripts/Gamebeifen.js"],"names":["PokerUtil","require","AIHelper","self","cc","Class","Component","properties","starPrefab","type","Prefab","cardPrefab","maxStarDuration","minStarDuration","currentCardPosition","startCardPostion","cardWidth","logicHelper","cardArray","String","pokerPlayer","roundPoker","sendArray","playerControlNodeArray","refreshButton","Button","sendButton","backButton","currentWinner","gameHost","layoutContainer","Layout","layoutBottom","layoutTop","layoutLeft","layoutRight","logLabel","Label","playLog","ground","Node","player","scoreDisplay","scoreAudio","AudioClip","onLoad","groundY","y","height","timer","starDuration","i","pre","j","str","push","node","on","refreshCallback","sendCallback","backClick","publishPokers","score","onRoundCallBack","bind","roundProgram","onUserPlayCallBack","roundOverCallBack","roundHost","currentPlayer","console","log","sendCard","sendAIFollowCard","saveRoundPoker","winnerPosition","sumSocer","setTimeout","destoryArray","appendLog","button","director","loadScene","willSendCard","length","getComponent","isCheck","Array","isArray","picNum","message","checkUserCanSend","destroy","splice","index","offset","newStar","instantiate","scaleX","scaleY","addChild","removePokerFromArray","spawnNewStar","setPosition","getNewStarPosition","game","Math","random","spawnBottomCard","destoryNode","createBottomCard","startPosition","userObj","total","randX","randY","jumpHeight","maxX","width","v2","getCardBottomPosition","update","dt","gainScore","string","audioEngine","playEffect","gameOver","stopAllActions","pokerArray","slice","host","parseInt","playerPokerArray","pokerNum","value","quaryPokerTypeValue","quaryPokerValue","expandPlayer","playerObj","sortPokers","JSON","stringify","location"],"mappings":"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","sourceRoot":"/","sourcesContent":["\nlet PokerUtil = require(\"PokerUtil\");\nlet AIHelper = require(\"AIHelper\");\nlet self;\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // 这个属性引用了星星预制资源\n        starPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        cardPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        // 星星产生后消失时间的随机范围\n        maxStarDuration: 0,\n        minStarDuration: 0,\n        currentCardPosition: 0,\n        startCardPostion: 0,\n        cardWidth: 80,\n        logicHelper: null,\n        cardArray: [cc.String],\n        //初始牌数组 逆时针 主角是第一个数组\n        pokerPlayer: [],\n        //当前轮次出牌节点,\n        roundPoker: [],\n        sendArray:[],\n        //主角当前牌节点\n        playerControlNodeArray: [],\n        //洗牌\n        refreshButton: {\n            default: null,\n            type: cc.Button\n        },\n        //出牌\n        sendButton: {\n            default: null,\n            type: cc.Button\n        },\n        //出牌\n        backButton: {\n            default: null,\n            type: cc.Button\n        },\n\n        //当前胜方\n        currentWinner: 1,\n        //本轮主\n        gameHost: \"1\",\n        //玩家拥有牌\n        layoutContainer: {\n            default: null,\n            type: cc.Layout\n        },\n        //玩家出的牌 \n        layoutBottom: {\n            default: null,\n            type: cc.Layout\n        },\n        //对家出牌 第三位\n        layoutTop: {\n            default: null,\n            type: cc.Layout\n        },\n        //下家出牌 左手第二位\n        layoutLeft: {\n            default: null,\n            type: cc.Layout\n        },\n        //上家出牌，右手第四位\n        layoutRight: {\n            default: null,\n            type: cc.Layout\n        },\n        //战报\n        logLabel: {\n            default: null,\n            type: cc.Label\n        },\n        playLog: \"游戏开始\",\n        // 地面节点，用于确定星星生成的高度\n        ground: {\n            default: null,\n            type: cc.Node\n        },\n        // player 节点，用于获取主角弹跳的高度，和控制主角行动开关\n        player: {\n            default: null,\n            type: cc.Node\n        },\n        // score label 的引用\n        scoreDisplay: {\n            default: null,\n            type: cc.Label\n        },\n        // 得分音效资源\n        scoreAudio: {\n            default: null,\n            type: cc.AudioClip\n        },\n    },\n\n    onLoad: function () {\n        self=this;\n        // 获取地平面的 y 轴坐标\n        this.groundY = this.ground.y + this.ground.height / 2;\n        // 初始化计时器\n        this.timer = 0;\n        this.starDuration = 0;\n        this.logicHelper = new AIHelper();\n        //创建图片资源\n        for (let i = 0; i < 13; i++) {\n            let pre = 3 + i;\n            for (let j = 1; j < 5; j++) {\n                let str = \"\";\n                if (pre < 10) {\n                    str = \"0\";\n                }\n                str = str + pre + j;\n                this.cardArray.push(str);\n                this.cardArray.push(str);\n            }\n        }\n        this.cardArray.push(\"161\");\n        this.cardArray.push(\"161\");\n        this.cardArray.push(\"171\");\n        this.cardArray.push(\"171\");\n\n\n        this.refreshButton.node.on('click', this.refreshCallback, this);\n        this.sendButton.node.on('click', this.sendCallback, this);\n        this.backButton.node.on('click',this.backClick, this)\n        this.publishPokers();\n        // this.spawnNewStar();\n        // 初始化计分\n        this.score = 0;\n        // this.onRoundCallBack=this.onRoundCallBack.bind(this);\n        this.onRoundCallBack=this.onRoundCallBack.bind(this);\n        this.logicHelper.roundProgram(this.onUserPlayCallBack,this.onRoundCallBack,this.roundOverCallBack,0,this.gameHost,[]);\n    },\n    /**\n     * 电脑出牌，直接渲染\n     * @param gameHost\n     * @param roundHost\n     * @param sendArray\n     * @param currentPlayer\n     */\n     onRoundCallBack:(gameHost, roundHost, sendArray, currentPlayer)=>{\n         self.roundHost=roundHost;\n         self.sendArray=sendArray;\n         console.log(\"onion\",\"轮次回调\"+sendArray);\n       let sendCard= self.logicHelper.sendAIFollowCard(self.gameHost, roundHost, sendArray, self.pokerPlayer[currentPlayer]);\n       console.log(\"onion\",\"轮次出牌\"+sendCard);\n        // sendArray.push(sendCard);\n        self.saveRoundPoker(sendCard, currentPlayer+1, 0);\n        return sendCard;\n    },\n    /**\n     * 玩家出牌 出牌按钮可以点击\n     * @param gameHost\n     * @param roundHost\n     * @param sendArray\n     * @param currentPlayer\n     */\n    onUserPlayCallBack:(gameHost, roundHost, sendArray, currentPlayer)=>{\n        console.log(\"onion\",\"回调到user\"+sendArray);\n    },\n\n    roundOverCallBack:(winnerPosition,sumSocer)=>{\n        setTimeout(()=>{\n            PokerUtil.destoryArray(self.roundPoker);\n            self.score=sumSocer+self.score;\n            self.roundHost=null;\n            self.appendLog(winnerPosition+\"大,捞分\"+sumSocer);\n            // self.logicHelper.roundProgram(self.onUserPlayCallBack,self.onRoundCallBack,\n            //     self.roundOverCallBack,winnerPosition,self.gameHost,[]);\n        },1000);\n        \n    },\n\n\n    refreshCallback: function (button) {\n        this.publishPokers();\n    },\n    backClick:function(button){\n        console.log(\"onion\",\"backClick\");\n        cc.director.loadScene(\"other\");\n    },\n    sendCallback: function (button) {\n        // let sendArray = [];\n        let willSendCard=null;\n        for (let i = 0; i < this.playerControlNodeArray.length;i++) {\n            //判断是否可出\n            let node = this.playerControlNodeArray[i].getComponent('Card');\n            if (node.isCheck) {\n                if(willSendCard&&!Array.isArray(willSendCard)){\n                    willSendCard=[];\n                    willSendCard.push(node.picNum);\n                }else{\n                    willSendCard=node.picNum;\n                }\n                \n            }\n            // this.playerControlNodeArray[i].destroy();\n        }\n        let message=this.logicHelper.checkUserCanSend(this.gameHost,this.roundHost,this.pokerPlayer[0],willSendCard);\n        if(!message){\n            console.log(\"onion\",\"不能出\"+message);\n            return\n        }\n\n        //出牌 移除并添加\n        for (let i = 0; i < this.playerControlNodeArray.length;) {\n            //判断是否可出\n            let node = this.playerControlNodeArray[i].getComponent('Card');\n            if (node.isCheck) {\n                // willSendArray.push(node.picNum);\n                this.saveRoundPoker(node.picNum, 1, i * this.cardWidth);\n                this.playerControlNodeArray[i].destroy();\n                this.playerControlNodeArray.splice(i, 1);\n            } else {\n                i++;\n            }\n            // this.playerControlNodeArray[i].destroy();\n        }\n        if(!this.sendArray){\n            this.sendArray=[];\n        }\n        this.sendArray.push(willSendCard);\n        this.logicHelper.roundProgram(this.onUserPlayCallBack,this.onRoundCallBack,\n            this.roundOverCallBack,0,this.gameHost,this.sendArray);\n       \n    },\n    //保存出牌  1 2 3 4 顺时针位\n    saveRoundPoker: function (picNum, index, offset) {\n        var newStar = cc.instantiate(this.cardPrefab);\n        // newStar.setPicNum(\"i\"+i);\n        newStar.getComponent('Card').picNum = picNum;\n        newStar.scaleX = 0.5;\n        newStar.scaleY = 0.5;\n        this.roundPoker.push(newStar);\n        console.log(\"onion\",\"保存出牌\"+picNum+\"index\"+index);\n        // this.node.addChild(newStar);\n        // let height = this.ground.height / 2 * -1;\n        switch (index) {\n            case 1: this.layoutBottom.node.addChild(newStar);\n                this.logicHelper.removePokerFromArray(this.gameHost, picNum, this.pokerPlayer[0]);\n                break;\n            case 2: this.layoutLeft.node.addChild(newStar);\n                this.logicHelper.removePokerFromArray(this.gameHost, picNum, this.pokerPlayer[1]);\n                break;\n            case 3: this.layoutTop.node.addChild(newStar);\n                this.logicHelper.removePokerFromArray(this.gameHost, picNum, this.pokerPlayer[2]);\n                break;\n            case 4: this.layoutRight.node.addChild(newStar);\n                this.logicHelper.removePokerFromArray(this.gameHost, picNum, this.pokerPlayer[3]);\n                break;\n        }\n        // newStar.setPosition(cc.v2(-150 + this.startCardPostion + offset, height));\n    },\n    spawnNewStar: function () {\n        // 使用给定的模板在场景中生成一个新节点\n        var newStar = cc.instantiate(this.starPrefab);\n        // 将新增的节点添加到 Canvas 节点下面\n        this.node.addChild(newStar);\n        // 为星星设置一个随机位置\n        newStar.setPosition(this.getNewStarPosition());\n        // 在星星组件上暂存 Game 对象的引用\n        newStar.getComponent('Star').game = this;\n        // 重置计时器，根据消失时间范围随机取一个值\n        this.starDuration = this.minStarDuration + Math.random() * (this.maxStarDuration - this.minStarDuration);\n        this.timer = 0;\n    },\n    /**\n     * 移除旧的节点\n     * 添加新节点\n     */\n    spawnBottomCard: function () {\n        if (this.playerControlNodeArray.length > 0) {\n            let destoryNode = this.playerControlNodeArray;\n            PokerUtil.destoryArray(destoryNode);\n            this.playerControlNodeArray = [];\n        }\n\n        this.createBottomCard()\n\n    },\n\n    /**\n     * type1Array:type1Array,\n            type2Array:type2Array,\n            type3Array:type3Array,\n            type4Array:type4Array,\n            hostArray:hostArray,\n            total:total\n     */\n    createBottomCard: function () {\n\n        let startPosition = 0;\n        let userObj = this.pokerPlayer[0];\n        for (let i = 0; i < userObj.total.length; i++) {\n            // 使用给定的模板在场景中生成一个新节点\n            var newStar = cc.instantiate(this.cardPrefab);\n            // newStar.setPicNum(\"i\"+i);\n            newStar.getComponent('Card').picNum = userObj.total[i];\n            this.playerControlNodeArray.push(newStar);\n            // this.node.addChild(newStar);\n            this.layoutContainer.node.addChild(newStar);\n            let height = this.ground.height / 2 * -1;\n            startPosition = i * this.cardWidth;\n            if (i > 13) {\n                height = height - 150\n                startPosition = (i - 13) * this.cardWidth;\n            }\n            // newStar.setPosition(cc.v2(-200 + this.startCardPostion + startPosition, height));\n        }\n    },\n\n\n    getNewStarPosition: function () {\n        var randX = 0;\n        // 根据地平面位置和主角跳跃高度，随机得到一个星星的 y 坐标\n        var randY = this.groundY + Math.random() * this.player.getComponent('Player').jumpHeight + 50;\n        // 根据屏幕宽度，随机得到一个星星 x 坐标\n        var maxX = this.node.width / 2;\n        randX = (Math.random() - 0.5) * 2 * maxX;\n        // 返回星星坐标\n        return cc.v2(randX, randY);\n    },\n    getCardBottomPosition: function () {\n        var randX = this.currentCardPosition;\n        var randY = 0;\n        this.currentCardPosition = this.currentCardPosition + this.cardWidth;\n        return cc.v2(randX, randY);\n    },\n\n    update: function (dt) {\n        // 每帧更新计时器，超过限度还没有生成新的星星\n        // 就会调用游戏失败逻辑\n        // if (this.timer > this.starDuration) {\n        //     this.gameOver();\n        //     this.enabled = false;   // disable gameOver logic to avoid load scene repeatedly\n        //     return;\n        // }\n        // this.timer += dt;\n    },\n\n    gainScore: function () {\n        this.score += 1;\n        // 更新 scoreDisplay Label 的文字\n        this.scoreDisplay.string = 'Score: ' + this.score;\n        // 播放得分音效\n        cc.audioEngine.playEffect(this.scoreAudio, false);\n    },\n\n    gameOver: function () {\n        this.player.stopAllActions(); //停止 player 节点的跳跃动作\n        cc.director.loadScene('game');\n    },\n\n    /**\n    * 把牌发给四家\n    */\n    publishPokers: function () {\n        this.pokerPlayer = [];\n        this.gameHost = null;\n        let pokerArray = this.cardArray.slice(0);\n        let host = parseInt(Math.random() * 4);//随机主牌花色\n        for (let i = 0; i < 4; i++) {\n            let playerPokerArray = [];\n            for (let j = 0; j < 27; j++) {\n                let pokerNum = Math.random() * pokerArray.length;\n                pokerNum = parseInt(pokerNum);\n                //插入手牌中\n                let value = pokerArray.splice(pokerNum, 1);\n                playerPokerArray.push(value);\n                if (this.gameHost == null) {//随机到主后，第一张主牌亮出\n                    if (host == PokerUtil.quaryPokerTypeValue(value)) {\n                        this.gameHost = value;\n                        this.appendLog(\"本轮游戏,主牌\" + PokerUtil.quaryPokerValue(value) + \"在\" + this.expandPlayer(i));\n                    }\n                }\n            }\n            let playerObj = PokerUtil.sortPokers(host, playerPokerArray);\n            console.log(\"onion====\", JSON.stringify(playerObj));\n            this.pokerPlayer.push(playerObj);\n        }\n        this.spawnBottomCard();\n\n    },\n    expandPlayer: function (location) {\n        switch (location) {\n            case 0: return \"自己\"\n            case 1: return \"下家\"\n            case 2: return \"对家\"\n            case 3: return \"上家\"\n        }\n\n    },\n    appendLog: function (string) {\n        this.playLog = this.playLog + \"\\n\" + string;\n        this.logLabel.string = this.playLog;\n    }\n\n\n\n\n\n});\n"]}